import{u as h,j as e,s as w}from"./index-p6RFt118.js";import{r as a}from"./react-vendor-CBH9K-97.js";import{a as k}from"./apiClient-2onQ2JwX.js";import{u as E,c as C}from"./router-BsRkIn4w.js";import"./socket-TjCxX7sJ.js";import"./state-CJScMKLL.js";function R(){const o=E(),{sessionCode:l}=C(),{selections:r,toggleSelection:b,participants:n}=h(),[g,p]=a.useState([]),[f,j]=a.useState(!0),[c,d]=a.useState(!1),[N,y]=a.useState(!1),[m,i]=a.useState(""),[u,v]=a.useState(0);a.useEffect(()=>{(async()=>{try{const s=await k();p(s)}catch(s){i(s instanceof Error?s.message:"Failed to load options")}finally{j(!1)}})()},[]),a.useEffect(()=>{const t=n.filter(s=>s.hasSubmitted).length;v(t)},[n]);const x=h(t=>t.sessionStatus);a.useEffect(()=>{x==="complete"&&o(`/session/${l}/results`)},[x,l,o]);const S=async()=>{if(r.length===0){i("Please select at least one option");return}if(!l){i("Session code not found");return}d(!0),i("");try{await w(l,r),y(!0)}catch(t){i(t instanceof Error?t.message:"Failed to submit selections"),d(!1)}};return f?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading options..."})]})}):N?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 px-4",children:e.jsx("div",{className:"max-w-md w-full text-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âœ“"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Selections Submitted!"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Waiting for other participants..."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[u," of ",n.length," participants have submitted"]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${u/n.length*100}%`}})})]}),e.jsx("p",{className:"text-xs text-gray-400",children:"Results will appear automatically when everyone submits"})]})})}):e.jsx("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 px-4 py-8",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Select Your Preferences"}),e.jsx("p",{className:"text-gray-600",children:"Choose all options you'd be happy with"}),e.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:[r.length," selected"]})]}),m&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:m})}),e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-4 mb-6 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"space-y-2",children:g.map(t=>{const s=r.includes(t.optionId);return e.jsx("button",{onClick:()=>b(t.optionId),className:`w-full min-h-[44px] p-4 text-left rounded-lg border-2 transition-all active:scale-[0.98] ${s?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-6 h-6 rounded border-2 flex items-center justify-center flex-shrink-0 ${s?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:s&&e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.displayName}),t.description&&e.jsx("p",{className:"text-sm text-gray-500",children:t.description})]})]})},t.optionId)})})}),e.jsx("button",{onClick:S,disabled:c||r.length===0,className:"w-full min-h-[44px] px-6 py-3 text-lg font-semibold text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed active:scale-[0.98] transition-all shadow-lg",children:c?"Submitting...":`Submit ${r.length} Selection${r.length!==1?"s":""}`}),e.jsx("div",{className:"mt-4 text-center text-sm text-gray-500",children:e.jsx("p",{children:"ðŸ”’ Your selections are private until everyone submits"})})]})})}export{R as default};
//# sourceMappingURL=SelectionPage-D9qL67qd.js.map
