const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/HomePage-nPEfO6tE.js","assets/router-BsRkIn4w.js","assets/react-vendor-CBH9K-97.js","assets/socket-TjCxX7sJ.js","assets/state-CJScMKLL.js","assets/CreateSessionPage-DDJFxosO.js","assets/apiClient-BaExMi9y.js","assets/JoinSessionPage-7Oq78usp.js","assets/SessionLobbyPage-Bv3jHUxA.js","assets/SelectionPage-BX4CS7AO.js","assets/ResultsPage-CKCJBB2J.js"])))=>i.map(i=>d[i]);
import{r as R,b as k,a as $}from"./react-vendor-CBH9K-97.js";import{B,R as M,a as I}from"./router-BsRkIn4w.js";import{l as q}from"./socket-TjCxX7sJ.js";import{c as W}from"./state-CJScMKLL.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(t){if(t.ep)return;t.ep=!0;const n=s(t);fetch(t.href,n)}})();var z={exports:{}},j={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K=R,X=Symbol.for("react.element"),G=Symbol.for("react.fragment"),Y=Object.prototype.hasOwnProperty,Q=K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Z={key:!0,ref:!0,__self:!0,__source:!0};function F(e,r,s){var o,t={},n=null,u=null;s!==void 0&&(n=""+s),r.key!==void 0&&(n=""+r.key),r.ref!==void 0&&(u=r.ref);for(o in r)Y.call(r,o)&&!Z.hasOwnProperty(o)&&(t[o]=r[o]);if(e&&e.defaultProps)for(o in r=e.defaultProps,r)t[o]===void 0&&(t[o]=r[o]);return{$$typeof:X,type:e,key:n,ref:u,props:t,_owner:Q.current}}j.Fragment=G;j.jsx=F;j.jsxs=F;z.exports=j;var v=z.exports,L={},D=k;L.createRoot=D.createRoot,L.hydrateRoot=D.hydrateRoot;const V="modulepreload",ee=function(e){return"/"+e},N={},O=function(r,s,o){let t=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));t=Promise.allSettled(s.map(S=>{if(S=ee(S),S in N)return;N[S]=!0;const m=S.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${p}`))return;const y=document.createElement("link");if(y.rel=m?"stylesheet":V,m||(y.as="script"),y.crossOrigin="",y.href=S,d&&y.setAttribute("nonce",d),document.head.appendChild(y),m)return new Promise((g,h)=>{y.addEventListener("load",g),y.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${S}`)))})}))}function n(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return t.then(u=>{for(const d of u||[])d.status==="rejected"&&n(d.reason);return r().catch(n)})},x={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},T=new Map,w=e=>{const r=T.get(e);return r?Object.fromEntries(Object.entries(r.stores).map(([s,o])=>[s,o.getState()])):{}},te=(e,r,s)=>{if(e===void 0)return{type:"untracked",connection:r.connect(s)};const o=T.get(s.name);if(o)return{type:"tracked",store:e,...o};const t={connection:r.connect(s),stores:{}};return T.set(s.name,t),{type:"tracked",store:e,...t}},ne=(e,r={})=>(s,o,t)=>{const{enabled:n,anonymousActionType:u,store:d,...S}=r;let m;try{m=(n??(x?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!m)return(x?"production":void 0)!=="production"&&n&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(s,o,t);const{connection:p,...y}=te(d,m,S);let g=!0;t.setState=(a,c,l)=>{const i=s(a,c);if(!g)return i;const _=l===void 0?{type:u||"anonymous"}:typeof l=="string"?{type:l}:l;return d===void 0?(p==null||p.send(_,o()),i):(p==null||p.send({..._,type:`${d}/${_.type}`},{...w(S.name),[d]:t.getState()}),i)};const h=(...a)=>{const c=g;g=!1,s(...a),g=c},E=e(t.setState,o,t);if(y.type==="untracked"?p==null||p.init(E):(y.stores[y.store]=t,p==null||p.init(Object.fromEntries(Object.entries(y.stores).map(([a,c])=>[a,a===y.store?E:c.getState()])))),t.dispatchFromDevtools&&typeof t.dispatch=="function"){let a=!1;const c=t.dispatch;t.dispatch=(...l)=>{(x?"production":void 0)!=="production"&&l[0].type==="__setState"&&!a&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),a=!0),c(...l)}}return p.subscribe(a=>{var c;switch(a.type){case"ACTION":if(typeof a.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return C(a.payload,l=>{if(l.type==="__setState"){if(d===void 0){h(l.state);return}Object.keys(l.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const i=l.state[d];if(i==null)return;JSON.stringify(t.getState())!==JSON.stringify(i)&&h(i);return}t.dispatchFromDevtools&&typeof t.dispatch=="function"&&t.dispatch(l)});case"DISPATCH":switch(a.payload.type){case"RESET":return h(E),d===void 0?p==null?void 0:p.init(t.getState()):p==null?void 0:p.init(w(S.name));case"COMMIT":if(d===void 0){p==null||p.init(t.getState());return}return p==null?void 0:p.init(w(S.name));case"ROLLBACK":return C(a.state,l=>{if(d===void 0){h(l),p==null||p.init(t.getState());return}h(l[d]),p==null||p.init(w(S.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return C(a.state,l=>{if(d===void 0){h(l);return}JSON.stringify(t.getState())!==JSON.stringify(l[d])&&h(l[d])});case"IMPORT_STATE":{const{nextLiftedState:l}=a.payload,i=(c=l.computedStates.slice(-1)[0])==null?void 0:c.state;if(!i)return;h(d===void 0?i:i[d]),p==null||p.send(null,l);return}case"PAUSE_RECORDING":return g=!g}return}}),E},re=ne,C=(e,r)=>{let s;try{s=JSON.parse(e)}catch(o){console.error("[zustand devtools middleware] Could not parse the received json",o)}s!==void 0&&r(s)};function oe(e,r){let s;try{s=e()}catch{return}return{getItem:t=>{var n;const u=S=>S===null?null:JSON.parse(S,void 0),d=(n=s.getItem(t))!=null?n:null;return d instanceof Promise?d.then(u):u(d)},setItem:(t,n)=>s.setItem(t,JSON.stringify(n,void 0)),removeItem:t=>s.removeItem(t)}}const P=e=>r=>{try{const s=e(r);return s instanceof Promise?s:{then(o){return P(o)(s)},catch(o){return this}}}catch(s){return{then(o){return this},catch(o){return P(o)(s)}}}},se=(e,r)=>(s,o,t)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:c=>c,version:0,merge:(c,l)=>({...l,...c}),...r},u=!1;const d=new Set,S=new Set;let m;try{m=n.getStorage()}catch{}if(!m)return e((...c)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...c)},o,t);const p=P(n.serialize),y=()=>{const c=n.partialize({...o()});let l;const i=p({state:c,version:n.version}).then(_=>m.setItem(n.name,_)).catch(_=>{l=_});if(l)throw l;return i},g=t.setState;t.setState=(c,l)=>{g(c,l),y()};const h=e((...c)=>{s(...c),y()},o,t);let E;const a=()=>{var c;if(!m)return;u=!1,d.forEach(i=>i(o()));const l=((c=n.onRehydrateStorage)==null?void 0:c.call(n,o()))||void 0;return P(m.getItem.bind(m))(n.name).then(i=>{if(i)return n.deserialize(i)}).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==n.version){if(n.migrate)return n.migrate(i.state,i.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return i.state}).then(i=>{var _;return E=n.merge(i,(_=o())!=null?_:h),s(E,!0),y()}).then(()=>{l==null||l(E,void 0),u=!0,S.forEach(i=>i(E))}).catch(i=>{l==null||l(void 0,i)})};return t.persist={setOptions:c=>{n={...n,...c},c.getStorage&&(m=c.getStorage())},clearStorage:()=>{m==null||m.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>a(),hasHydrated:()=>u,onHydrate:c=>(d.add(c),()=>{d.delete(c)}),onFinishHydration:c=>(S.add(c),()=>{S.delete(c)})},a(),E||h},ie=(e,r)=>(s,o,t)=>{let n={storage:oe(()=>localStorage),partialize:a=>a,version:0,merge:(a,c)=>({...c,...a}),...r},u=!1;const d=new Set,S=new Set;let m=n.storage;if(!m)return e((...a)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),s(...a)},o,t);const p=()=>{const a=n.partialize({...o()});return m.setItem(n.name,{state:a,version:n.version})},y=t.setState;t.setState=(a,c)=>{y(a,c),p()};const g=e((...a)=>{s(...a),p()},o,t);t.getInitialState=()=>g;let h;const E=()=>{var a,c;if(!m)return;u=!1,d.forEach(i=>{var _;return i((_=o())!=null?_:g)});const l=((c=n.onRehydrateStorage)==null?void 0:c.call(n,(a=o())!=null?a:g))||void 0;return P(m.getItem.bind(m))(n.name).then(i=>{if(i)if(typeof i.version=="number"&&i.version!==n.version){if(n.migrate)return[!0,n.migrate(i.state,i.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,i.state];return[!1,void 0]}).then(i=>{var _;const[H,J]=i;if(h=n.merge(J,(_=o())!=null?_:g),s(h,!0),H)return p()}).then(()=>{l==null||l(h,void 0),h=o(),u=!0,S.forEach(i=>i(h))}).catch(i=>{l==null||l(void 0,i)})};return t.persist={setOptions:a=>{n={...n,...a},a.storage&&(m=a.storage)},clearStorage:()=>{m==null||m.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>E(),hasHydrated:()=>u,onHydrate:a=>(d.add(a),()=>{d.delete(a)}),onFinishHydration:a=>(S.add(a),()=>{S.delete(a)})},n.skipHydration||E(),h||g},ae=(e,r)=>"getStorage"in r||"serialize"in r||"deserialize"in r?((x?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),se(e,r)):ie(e,r),ce=ae,A={sessionCode:null,participants:[],currentUserId:null,selections:[],allSelections:{},overlappingOptions:[],sessionStatus:"waiting",isConnected:!1},b=W()(re(ce(e=>({...A,setSessionCode:r=>e({sessionCode:r}),setCurrentUserId:r=>e({currentUserId:r}),addParticipant:r=>e(s=>({participants:[...s.participants,r]})),removeParticipant:r=>e(s=>({participants:s.participants.filter(o=>o.participantId!==r)})),updateParticipants:r=>e({participants:r}),setSelections:r=>e({selections:r}),toggleSelection:r=>e(s=>({selections:s.selections.includes(r)?s.selections.filter(t=>t!==r):[...s.selections,r]})),setResults:r=>e({allSelections:r.allSelections,overlappingOptions:r.overlappingOptions,sessionStatus:"complete"}),setSessionStatus:r=>e({sessionStatus:r}),setConnectionStatus:r=>e({isConnected:r}),resetSession:()=>e(A),resetSelections:()=>e({selections:[],allSelections:{},overlappingOptions:[],sessionStatus:"selecting"})}),{name:"dinner-session-storage"}),{name:"DinnerSession"})),le="http://localhost:3001";let f=null;function de(){if(f!=null&&f.connected){console.log("Socket already connected");return}f=q(le,{reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:1e4}),f.on("connect",()=>{const e=f==null?void 0:f.id;console.log("Socket connected:",e),b.getState().setConnectionStatus(!0),e&&b.getState().setCurrentUserId(e)}),f.on("disconnect",e=>{console.log("Socket disconnected:",e),b.getState().setConnectionStatus(!1)}),f.on("connect_error",e=>{console.error("Socket connection error:",e),b.getState().setConnectionStatus(!1)}),ue()}function ue(){f&&(f.on("participant:joined",e=>{console.log("Participant joined:",e),b.getState().addParticipant({participantId:e.participantId,displayName:e.displayName,sessionCode:"",joinedAt:Date.now(),hasSubmitted:!1,isHost:!1})}),f.on("participant:left",e=>{console.log("Participant left:",e),b.getState().removeParticipant(e.participantId)}),f.on("participant:submitted",e=>{console.log("Participant submitted:",e);const r=b.getState(),s=r.participants.map(o=>o.participantId===e.participantId?{...o,hasSubmitted:!0}:o);r.updateParticipants(s)}),f.on("session:results",e=>{console.log("Session results:",e),b.getState().setResults({sessionCode:e.sessionCode,overlappingOptions:e.overlappingOptions,allSelections:e.allSelections,hasOverlap:e.hasOverlap})}),f.on("session:restarted",e=>{console.log("Session restarted:",e),b.getState().resetSelections()}),f.on("session:expired",e=>{console.log("Session expired:",e),b.getState().setSessionStatus("expired")}),f.on("error",e=>{console.error("Socket error:",e)}))}function Re(e,r){return new Promise((s,o)=>{if(!(f!=null&&f.connected)){o(new Error("Socket not connected"));return}const t={sessionCode:e,displayName:r};f.emit("session:join",t,n=>{n.success&&n.participants?(b.getState().setSessionCode(e),b.getState().updateParticipants(n.participants.map(u=>({...u,sessionCode:e,joinedAt:Date.now(),hasSubmitted:!1}))),s(n)):o(new Error(n.error||"Failed to join session"))})})}function Ie(e,r){return new Promise((s,o)=>{if(!(f!=null&&f.connected)){o(new Error("Socket not connected"));return}const t={sessionCode:e,selections:r};f.emit("selection:submit",t,n=>{n.success?s(n):o(new Error(n.error||"Failed to submit selection"))})})}function Oe(e){return new Promise((r,s)=>{if(!(f!=null&&f.connected)){s(new Error("Socket not connected"));return}const o={sessionCode:e};f.emit("session:restart",o,t=>{t.success?r():s(new Error(t.error||"Failed to restart session"))})})}const U=R.lazy(()=>O(()=>import("./HomePage-nPEfO6tE.js"),__vite__mapDeps([0,1,2,3,4]))),pe=R.lazy(()=>O(()=>import("./CreateSessionPage-DDJFxosO.js"),__vite__mapDeps([5,2,6,1,3,4]))),fe=R.lazy(()=>O(()=>import("./JoinSessionPage-7Oq78usp.js"),__vite__mapDeps([7,2,1,3,4]))),me=R.lazy(()=>O(()=>import("./SessionLobbyPage-Bv3jHUxA.js"),__vite__mapDeps([8,2,6,1,3,4]))),Se=R.lazy(()=>O(()=>import("./SelectionPage-BX4CS7AO.js"),__vite__mapDeps([9,2,6,1,3,4]))),ve=R.lazy(()=>O(()=>import("./ResultsPage-CKCJBB2J.js"),__vite__mapDeps([10,2,1,3,4])));function he(){return v.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),v.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})})}function ye(){return R.useEffect(()=>(de(),()=>{}),[]),v.jsx(B,{children:v.jsx(R.Suspense,{fallback:v.jsx(he,{}),children:v.jsxs(M,{children:[v.jsx(I,{path:"/",element:v.jsx(U,{})}),v.jsx(I,{path:"/create",element:v.jsx(pe,{})}),v.jsx(I,{path:"/join",element:v.jsx(fe,{})}),v.jsx(I,{path:"/session/:sessionCode",element:v.jsx(me,{})}),v.jsx(I,{path:"/session/:sessionCode/select",element:v.jsx(Se,{})}),v.jsx(I,{path:"/session/:sessionCode/results",element:v.jsx(ve,{})}),v.jsx(I,{path:"*",element:v.jsx(U,{})})]})})})}L.createRoot(document.getElementById("root")).render(v.jsx($.StrictMode,{children:v.jsx(ye,{})}));export{Re as a,v as j,Oe as r,Ie as s,b as u};
//# sourceMappingURL=index-CWGIdwLc.js.map
